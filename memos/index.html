<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>in-browser memopad with KaTeX</title>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
        integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
        integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
        crossorigin="anonymous"></script>
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
        integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous">
        </script>
    <style>
        textarea#contents {
            width: 100%;
            height: 60em;
        }
    </style>
</head>

<body>

    <div class="container-fluid">
        <div id="memopad" class="row">
            <div class="col-sm-5">
                <p id="preview">{{ preview }}</p>
            </div>
            <div class="col-sm-7">
                <textarea v-model="content" id="contents"></textarea>
            </div>
        </div>
    </div>
</body>

<script>
    let KEY = "IN_BROWSER_MEMOPAD"
    var data = localStorage.getItem(KEY)
    var app = new Vue({
        "el": "#memopad",
        "data": {
            "preview": data,
            "content": data
        },
        "watch": {
            "content": function () {
                this.preview = this.content
                // TODO: katex + vue.js 
                //renderMathInElement(document.getElementById("preview"))
            }
        }
    })
    function saveToLocalStorage() {
        localStorage.setItem(KEY, app.content)
    }
    setInterval(saveToLocalStorage, 5000);
</script>

</html>